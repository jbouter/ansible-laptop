---

- name: Check if user vscode configuration dir exists
  ansible.builtin.stat:
    path: "/home/{{ username }}/.config/Code/User"
  register: stat_user_vscode_config

- name: Create vscode config directory
  ansible.builtin.file:
    path: "{{ item }}"
    state: directory
    owner: "{{ username }}"
    group: "{{ username }}"
    mode: '0775'
  loop:
    - "/home/{{ username }}/.config/Code"
    - "/home/{{ username }}/.config/Code/User"
  when: not stat_user_vscode_config.stat.exists

- name: Configure vscode for user
  ansible.builtin.copy:
    src: settings.json
    dest: "/home/{{ username }}/.config/Code/User/settings.json"
    force: no
    owner: "{{ username }}"
    group: "{{ username }}"
    mode: '0664'